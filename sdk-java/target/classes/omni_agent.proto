syntax = "proto3";

package omniagent;

option java_package = "com.deepknow.omniagent.grpc";
option java_outer_classname = "OmniAgentProto";
option java_multiple_files = true;

import "stt.proto";
import "llm.proto";
import "multimodal.proto";

// Omni-Agent gRPC 服务
// 提供统一多模态 AI 能力
service OmniAgentService {
  // ========== 统一多模态接口（推荐）==========
  
  // 非流式多模态处理：支持 text + audio + image 组合输入
  rpc Process(MultiModalRequest) returns (MultiModalResponse);
  
  // 流式多模态处理：支持实时音频输入 + 流式输出
  rpc ProcessStream(stream MultiModalStreamRequest) returns (stream MultiModalStreamResponse);
  
  // ========== 细粒度接口（保留）==========
  
  // STT 双向流：客户端发送音频帧，服务端返回识别结果
  rpc StreamSTT(stream SttRequest) returns (stream SttResponse);
  
  // LLM 流式调用：客户端发送问题，服务端流式返回答案
  rpc StreamChat(ChatRequest) returns (stream ChatResponse);
  
  // 健康检查
  rpc HealthCheck(HealthRequest) returns (HealthResponse);
}

message HealthRequest {}

message HealthResponse {
  bool healthy = 1;
  string version = 2;
  map<string, string> metadata = 3;
}
